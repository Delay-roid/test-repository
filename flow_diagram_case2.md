# 案②：エンジン実験データ処理フロー図

## 目的
時系列データから燃焼割合50%時の温度・圧力を抽出し、サイクル平均データに追加する。

## データ構造

### 入力1：サイクル平均データ（cycle_average.csv）
| 運転条件ID | 回転数(rpm) | トルク(Nm) |
|-----------|------------|-----------|
| RUN001    | 2000       | 150       |
| RUN002    | 2500       | 200       |
| RUN003    | 3000       | 180       |

### 入力2：時系列データ（timeseries.csv）
| 運転条件ID | クランク角度(deg) | 燃焼割合(%) | 温度(K) | 圧力(MPa) |
|-----------|------------------|------------|---------|-----------|
| RUN001    | -10              | 0          | 600     | 2.0       |
| RUN001    | -5               | 10         | 700     | 3.0       |
| RUN001    | 0                | 30         | 900     | 4.5       |
| RUN001    | 5                | 50         | 1200    | 6.0       |
| RUN001    | 10               | 70         | 1400    | 5.5       |

## 処理フロー
```
┌─────────────────────────────────────┐
│ 【開始】                              │
└─────────────────────────────────────┘
          ↓
┌─────────────────────────────────────┐
│ 1. 入力データの読み込み                 │
│  ├─ cycle_average.csv を読み込み      │
│  └─ timeseries.csv を読み込み         │
└─────────────────────────────────────┘
          ↓
┌─────────────────────────────────────┐
│ 2. 運転条件IDごとにループ処理           │
│    （RUN001, RUN002, RUN003...）      │
└─────────────────────────────────────┘
          ↓
┌─────────────────────────────────────┐
│ 3. 時系列データから50%時点を探す        │
│  ├─ 該当運転条件IDのデータを抽出       │
│  ├─ 燃焼割合が50%に最も近い行を特定   │
│  └─ その行の温度・圧力を取得          │
└─────────────────────────────────────┘
          ↓
┌─────────────────────────────────────┐
│ 4. サイクル平均データに列を追加         │
│  ├─ 「MFB50%時温度(K)」列を追加       │
│  └─ 「MFB50%時圧力(MPa)」列を追加     │
└─────────────────────────────────────┘
          ↓
┌─────────────────────────────────────┐
│ 5. 結果を出力                          │
│  └─ result.csv に保存                 │
└─────────────────────────────────────┘
          ↓
┌─────────────────────────────────────┐
│ 【終了】                              │
└─────────────────────────────────────┘
```

## 前提条件
- 時系列データに燃焼割合がちょうど50%のデータ点が存在する
- データ補間は今回は考慮しない（将来的に実装予定）

## 将来の改修予定（12月-1月）
- 50%ぴったりのデータがない場合の線形補間
- より現実的なデータ範囲の設定
- エラーハンドリング